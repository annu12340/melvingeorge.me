{"pageProps":{"content":"# How to make your Nextjs app into a progressive web app\n<p className=\"date\">Published June 6, 2020</p>\n\n![banner image](main.jpg)\n\n## Contents\n\n- [What is a PWA (Progressive Web app)?](#progressive-web-app)\n- [Make a `manifest.json` file](#make-manifest)\n- [Add `manifest.json` to Nextjs app](#add-manifest)\n- [Adding a service worker](#add-service-worker)\n- [Github Repo of this code](#github-repo)\n\n## <a name=\"progressive-web-app\"></a> What is a PWA (Progressive Web app)?\n\nLet's think it like this way,\nIt is a website but with some feature of a native mobile application:\n\n- It will work offline\n- Install like a native mobile application\n- A Native application like experience\n- It increases your web-app performance\n- It caches most of the content so you won't have to fetch for most common things every time\n- Increases your chance of being indexed by google search engines\n- More secure\n\nand many more.\n\n## <a name=\"make-manifest\"></a> Make a `manifest.json` file\n\n- Go to the `public` directory inside of your Nextjs application.\n- Create a file called `manifest.json`\n\n```json\n{\n  \"name\": \"<YOUR_APP_NAME>\",\n  \"short_name\": \"<YOUR_APP_SHORT_NAME>\",\n  \"start_url\": \"/\",\n  \"display\": \"standalone\",\n  \"background_color\": \"#90cdf4\",\n  \"theme_color\": \"#90cdf4\",\n  \"orientation\": \"portrait-primary\",\n  \"icons\": [\n    {\n      \"src\": \"/logo-72x72.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"72x72\"\n    },\n    {\n      \"src\": \"/logo-96x96.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"96x96\"\n    },\n    {\n      \"src\": \"/logo-128x128.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"128x128\"\n    },\n    {\n      \"src\": \"/logo-144x144.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"144x144\"\n    },\n    {\n      \"src\": \"/logo-152x152.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"152x152\"\n    },\n    {\n      \"src\": \"/logo-192x192.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"192x192\"\n    },\n    {\n      \"src\": \"/logo-384x384.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"384x384\"\n    },\n    {\n      \"src\": \"/logo-512x512.png\",\n      \"type\": \"image/png\",\n      \"sizes\": \"512x512\"\n    }\n  ]\n}\n```\n\n- `name`: application main name\n- `short_name`: application short name\n- `start_url`: the preferred URL that should be loaded when the user launches your web application\n- `display`: if given `standalone`, then web-app will be shown in a separate window\n- `background_color`: defines a placeholder background color for the application page to display before its stylesheet is loaded.\n- `theme_color`: defines the default theme color for the application.\n- `orientation` - defines the orientation of your application in the device.\n- `icons`- an array of different `sizes` of your application logo, its `type` and its `src` (source) to tell where to fetch the icon.\n\n### Note:\n\nThere is a cool[ Web app manifest generator](https://app-manifest.firebaseapp.com/) for this ðŸ˜ƒ.\n\n## <a name=\"add-manifest\"></a> Add `manifest.json` to Nextjs app\n\nLink your `manifest.json` file to your Nextjs app `head` tag.\n\n```html\n<!-- link manifest.json -->\n<link rel=\"manifest\" href=\"/manifest.json\" />\n<!-- this sets the color of url bar  -->\n<meta name=\"theme-color\" content=\"#90cdf4\" />\n```\n\nNow if you go to `Devtools` then clicking on the `Application` tab and then `Manifest` tab you can see all the fields are now generated, which shows that our `manifest.json` is valid now.\n\n![Manifest](manifest.png)\n\nNice ðŸŽŠ\n\n### Note:\n\nTo make this work on apple based smartphones you need to add this additionally.\n\n```html\n<!-- this sets logo in Apple smatphones. -->\n<link rel=\"apple-touch-icon\" href=\"/logo-96x96.png\" />\n<!-- this sets the color of url bar in Apple smatphones -->\n<meta name=\"apple-mobile-web-app-status-bar\" content=\"#90cdf4\" />\n```\n\n## <a name=\"add-service-worker\"></a> Adding a service worker\n\nFirst, let's install a package called `next-offline`\n\n```bash\nyarn add -D next-offline\n```\n\n### Add the `next-offline` package to Nextjs config\n\nCreate a file called `next.config.js` in the root of your project directory.\n\nThen add this piece of code,\n\n```javascript\nconst withOffline = require(\"next-offline\");\n\n// your next.js configs\nconst nextConfig = {};\n\nmodule.exports = withOffline(nextConfig);\n```\n\n### Make a server to route requests:\n\nRun in terminal\n\n```bash\nyarn add -D express\n```\n\nAfter that create `server.js` file to route your `/service-worker.js` file like this:\n\n```javascript\nconst express = require(\"express\");\nconst path = require(\"path\");\nconst next = require(\"next\");\n\nconst dev = process.env.NODE_ENV !== \"production\";\nconst app = next({ dev });\nconst handle = app.getRequestHandler();\n\napp\n  .prepare()\n  .then(() => {\n    const server = express();\n\n    // requests to /service-worker.js\n    server.get(\n      \"/service-worker.js\",\n      express.static(path.join(__dirname, \".next\"))\n    );\n\n    // all other requests\n    server.get(\"*\", (req, res) => {\n      return handle(req, res);\n    });\n    server.listen(3000, (err) => {\n      if (err) throw err;\n      console.log(\"> Ready on http://localhost:3000\");\n    });\n  })\n  .catch((ex) => {\n    console.error(ex.stack);\n    process.exit(1);\n  });\n```\n\nThis tells the server to fetch `/service-worker.js` from `.next` and let all other requests be handled by Nextjs itself.\n\n### Add a `scripts` command to `package.json` file:\n\n```json\n\"scripts\":{\n  \"server\": \"yarn build && NODE_ENV=production node server.js\",\n}\n```\n\nlike this.\n\n### Note:\n\nThe Service worker will be enabled only on production mode and not in development mode.\n\n### Check your service worker\n\nRun in terminal:\n\n```bash\nyarn server\n```\n\nGo to `localhost:3000`.\n\nGo to `Devtools` > `Application` tab > `Service Worker`.\n\n![Service Worker](serviceworker.png)\n\nYou can see that our service worker is now activated and running.\n\n### Check PWA with Lighthouse\n\nGo to `Devtools` > `Lighthouse` tab (or `Audit` tab) > `Generate Report`.\n\n![Generate Report](generatereport.png)\n\n![progressive Web Application](pwa.png)\n\nWe made our Nextjs app into a progressive web application ðŸ˜ƒðŸŽŠ.\n\n### <a name=\"github-repo\"></a> [Github Repo of this code](https://github.com/melvin2016/nextjs-pwa-blog)\n\n### Feel free to share if you found this useful.\n","frontMatter":{"title":"How to make your Nextjs app into a progressive web app","description":"Step by step tutorial on how to make your Nextjs app into a progressive web application","keywords":"how to,progressive web app,javascript,nextjs,reactjs,nextjs into progressive web app","category":"Nextjs","author":"MELVIN GEORGE","date":"June 6, 2020","link":"nextjs-pwa"}},"__N_SSG":true}